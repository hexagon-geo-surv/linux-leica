# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
# Copyright 2025 Matthias Fend <matthias.fend@emfend.at>
%YAML 1.2
---
$id: http://devicetree.org/schemas/media/i2c/himax,hm1246.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Himax HM1246-AWD 1/3.7-Inch megapixel SoC image sensor

maintainers:
  - Matthias Fend <matthias.fend@emfend.at>

description:
  The Himax HM1246-AWD is a 1/3.7-Inch CMOS image sensor SoC with an active
  array size of 1296 x 976. It is programmable through an I2C interface and
  connected via parallel bus.

allOf:
  - $ref: /schemas/media/video-interface-devices.yaml#

properties:
  compatible:
    const: himax,hm1246

  reg:
    maxItems: 1

  clocks:
    description: Input reference clock (6 - 27 MHz)
    maxItems: 1

  reset-gpios:
    description: Active low XSHUTDOWN pin
    maxItems: 1

  avdd-supply:
    description: Power for analog circuit (3.0 - 3.6 V)

  iovdd-supply:
    description: Power for I/O circuit (1.7 - 3.6 V)

  dvdd-supply:
    description: Power for digital circuit (1.5 / 1.8 V)

  port:
    $ref: /schemas/graph.yaml#/$defs/port-base
    additionalProperties: false
    description: Parallel video output port

    properties:
      endpoint:
        $ref: /schemas/media/video-interfaces.yaml#
        unevaluatedProperties: false

        properties:
          bus-type:
            const: 5

        required:
          - bus-type

    required:
      - endpoint

required:
  - compatible
  - reg
  - clocks
  - avdd-supply
  - iovdd-supply
  - dvdd-supply
  - port

unevaluatedProperties: false

examples:
  - |
    #include <dt-bindings/gpio/gpio.h>
    #include <dt-bindings/media/video-interfaces.h>

    i2c {
        #address-cells = <1>;
        #size-cells = <0>;

        sensor@24 {
            compatible =  "himax,hm1246";
            reg = <0x24>;

            clocks = <&hm1246_clk>;

            reset-gpios = <&gpio0 0 GPIO_ACTIVE_LOW>;

            avdd-supply = <&hm1246_avdd>;
            iovdd-supply = <&hm1246_iovdd>;
            dvdd-supply = <&hm1246_dvdd>;

            orientation = <2>;
            rotation = <0>;

            port {
                endpoint {
                    remote-endpoint = <&isp_par_in>;
                    bus-type = <MEDIA_BUS_TYPE_PARALLEL>;
                    bus-width = <10>;
                    hsync-active = <1>; /* active high */
                    vsync-active = <1>; /* active high */
                    pclk-sample = <1>; /* sample on rising edge */
                };
            };
        };
    };
